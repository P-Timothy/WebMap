<!DOCTYPE html>
<html>
    <head>
    <meta charset="utf-8">
    <title>Filter symbols by toggling a list</title>
    <meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no">
    <link href="https://api.mapbox.com/mapbox-gl-js/v2.2.0/mapbox-gl.css" rel="stylesheet">
    <script src="https://api.mapbox.com/mapbox-gl-js/v2.2.0/mapbox-gl.js"></script>
    <link rel="stylesheet" href="yearMapC.css">
    <link href="nouislider.css" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono&display=swap" rel="stylesheet">
    <script src="nouislider.js"></script>
        <!-- https://p-timothy.github.io/WebMap/Econ/yearMap.html -->
    <style>
        body { 
            margin: 0; padding: 0; 
        }
        #map { 
            position: absolute; top: 0; bottom: 0; width: 100%; 
        }
    </style>
    </head>
    
    <body>

        
        <div id="map"></div>
        
        <div id='topbar'>
            <div id="titlebar">
                <h2 id="title"> Japanese Manufacturing Plants 1912-1992 <sup id='info' onclick="infoBtn()">i</sup> <span id="menue">&vellip;</span> </h2>
                
            </div>

            <div id='userControl'>
                <div id="timePlayer">

                    <label class="switch" id='Play'>
                      <input type="checkbox" onclick="go()">
                      <span class="slider" id='playbutton'>Play</span>
                    </label>

                    <label class="switch" id="BtmLck">
                      <input type="checkbox" onclick="lockbottom()" checked>
                      <span class="slider" id='Lock'>Lock<br>Min-Year</span>
                    </label>

                    <span class="yearClass" id="minYear">1960</span>

                    <div class="slider-styled" id="slider"></div>

                    <span class="yearClassR" id="maxYear">1992</span>

                    <label class="switch" id="TopLock">
                      <input type="checkbox" onclick="locktop()">
                      <span class="slider" id='Lock'>Lock<br>Max-Year</span>
                    </label>
                    
                    <label class="switch" id="FilterButton">
                      <input type="checkbox" id="FiltersCheckBox" onclick="rtwsBtn()">
                      <span class="slider" id='rtws'>Right To <br> Work States</span>
                    </label>
                </div>
            </div>
            
            <div id="TABBY">
                <span id='TabsBB'>&minus;</span>
            </div>
        </div>
        
        
        
        <div id='Filters'>
            <div id="filterDiv">
                <span id="FilterX">&vellip;</span>
                <span id="FilterTitle">Filter:</span>
                <span class="closeLeg" onclick="FilBtn()" id='FilX'>&times;</span>
            </div>
            
            <div id="FilterHiddenSection">
                
                
                <div id='jvFilter'>
                    
                    <div class="jvtri-state-toggle">
                      <input class="jvButton" type="radio" name="toggle" id="jvone" onclick="settingTheFilter('nojv')"/>
                      <input class="jvButton" type="radio" name="toggle" id="jvtwo" onclick="settingTheFilter('jv')"/>
                      <input class="jvButton" type="radio" name="toggle" id="jvthree" onclick="settingTheFilter('alljv')"/>
                    </div>
                    <label for='jv'>Joint Venture</label><br>

                    
                    <div class="aqtri-state-toggle">
                      <input class="aqButton" type="radio" name="toggle" id="aqone" onclick="settingTheFilter('noaq')"/>
                      <input class="aqButton" type="radio" name="toggle" id="aqtwo" onclick="settingTheFilter('aq')"/>
                      <input class="aqButton" type="radio" name="toggle" id="aqthree" onclick="settingTheFilter('allaq')"/>
                    </div>
                    <label for='aq'>Acquisition</label><br>

                    
                    <div class="nwtri-state-toggle">
                      <input class="nwButton" type="radio" name="toggle" id="nwone" onclick="settingTheFilter('nonw')"/>
                      <input class="nwButton" type="radio" name="toggle" id="nwtwo" onclick="settingTheFilter('nw')"/>
                      <input class="nwButton" type="radio" name="toggle" id="nwthree" onclick="settingTheFilter('allnw')"/>
                    </div>
                    <label for='new'>New</label><br>
                </div>

                <div id="SIC1filter">
                    <label form="sicVal">SIC Code:</label>
                    <input type="text" id="sicVal" name="sicVal" list="options" onclick='sicValClick()'>
                    <datalist id="options">
                        <option value="Food" ></option>
                        <option value="Raw Materials" ></option>
                        <option value="Metal" ></option>
                        <option value="Machinery" ></option>
                        <option value="Electronics" ></option>
                        <option value="Automotives" ></option>
                        <option value="Misc" ></option>
                    </datalist>
                    <button onclick="sicGo()" id="goButton">Go</button>
                </div>
            </div>
            
        </div>

        
        
        
        <!-- Title Info Modal -->
        <div id="infoModal" class="modal">
          <!-- Modal content -->
            <div class="info-modal-content">
                <span class="close">&times;</span>

                <h2> Additional Info. </h2>
                
                <p>
                    Datasets: 
                    <br><br>
                    Points -    The point dataset used for this web map was provided by Bruce Blonigen. It is comprised of single points representing a Japanese Manufacturing plant in the United States of America. This dataset contains additional variables like, SIC number, types of prouducts, year established, locational information, as well as additional infomration of the parent companies. The GeoJson used for this project can be found <a href="https://github.com/p-timothy/WebMap/blob/main/Econ/EconUpdated.geojson"> here</a>.
                    <br><br>
                    Right To Work - The state polygons used come from the 2018 census, and were the 20m shapefiles. Data about states right to work was then added to the state polygon layer, this data was found at <a href="https://nrtwc.org/facts/state-right-to-work-timeline-2016/"> The National Right To Work Committee</a>. Visulizing all states with right to work dates before 1980.
                    <br><br>
                    Base Map -  The base map currently being used is a slightly customized version of the monochrome MapBox layer. (mapbox://styles/ptimmys/cli0j2lad00ul01po2d4t5fyo) 
                </p>
            </div>
        </div>
        
        <!-- Filter Info Modal -->
        <div id="filterInfoModal" class="modal">
          <!-- Modal content -->
            <div class="info-modal-content">

                <h2> Additional Filter Info. </h2>
                
                <p>
                    Filters: 
                    <br><br>
                    Switches - Filter by joint venture, acquisitions, or new manufacturing plants by switching a flip! The middle position means there is no filter currently being applied, the right position (green) means the filter for that layer is active, and the left position (red) means that layer is filtered out. <br>
                    Example: If the Joint Venture filter is green, all Joint Venture manufacuring plants will be shown (this includes some Acquisition plants). In order to just view the Joint Venture layer, the Joint Venture switch should be green and the Acquisition and New switches should be red. *Note that the datasets has some plants which are both Joint Ventures and Acquisitions, but no New plant is a Joint Venture or Aquisition. 
                    <br><br>
                    SIC filter - Filter by individual Standard Industrial Classification (ex: '3711'), SIC ranges (ex: '3100 3560'), or select a predefined range (ex: 'Machinery').
                    <br><br>
                </p>
            </div>
        </div>
        
        
        
        
        <div class="LegendContainer">
            
            <div id="Ltitle">
                <span id='LegTitle'>- Legend: &nbsp;</span>
                <span class="closeLeg" onclick="LegBtn()" id='legX'>&times;</span>
            </div>
            <div id="LegendItems">
                <div class="legendItem">
                    <span class="food" id='food'>&#11044;</span>
                    <span class="layerDescription">Food &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (sic: 2032-2099)</span>
                </div>
                <br>
                <div class="legendItem">
                    <span class="rawMaterials" id="rawMaterials">&#11044;</span>
                    <span class="layerDescription">Textiles/Raw Materials  (sic: 2259-3297)</span>
                </div>
                <br>
                <div class="legendItem">
                    <span class="metals" id="metals">&#11044;</span>
                    <span class="layerDescription">Metal Products &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (sic: 3312-3498)</span>
                </div>
                <br>
                <div class="legendItem">
                    <span class="machinery" id="machinery">&#11044;</span>
                    <span class="layerDescription">Machinery &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (sic: 3531-3593)</span>
                </div>
                <br>
                <div class="legendItem">
                    <span class="electronics" id="electronics">&#11044;</span>
                    <span class="layerDescription">Electronics &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (sic: 3616-3695)</span>
                </div>
                <br>
                <div class="legendItem">
                    <span class="auto" id="auto">&#11044;</span>
                    <span class="layerDescription">Automotives &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (sic: 3711-3716)</span>
                </div>
                <br>
                <div class="legendItem">
                    <span class="miscManf" id="miskManf">&#11044;</span>
                    <span class="layerDescription">Misc. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (sic: 3700-3999)</span>
                </div>
            </div>
        </div>
       
        
        <script>
            
            //////////////////////////////////////////////////////////
            //                     Mapbox setup                     //
            //////////////////////////////////////////////////////////
            mapboxgl.accessToken = 'pk.eyJ1IjoicHRpbW15cyIsImEiOiJjbGc1ZnAxenYwMnZ6M3NvOG0zcGpzZmx4In0.drh78VNuPvJOOpSrS8wsGQ';
            
            const bounds = [
                [-180,-5],[-30,76]
            ]
            
            //  load map  //
            var map = new mapboxgl.Map({
                container: 'map', // container id
                style: 'mapbox://styles/ptimmys/cli0j2lad00ul01po2d4t5fyo',  // stylesheet location
                    center: [-95.7129, 37.0902], 
                    zoom: 3,
                    minZoom: 1, 
                    maxZoom: 9,
                    maxBounds: bounds,
            });
            
            // load data when map is loaded
            map.on('load', function(){
                
                // add manfplants geojson source
                map.addSource('ManfPlants', {
                    'type': 'geojson',
                    data: './EconUpdated.geojson',
                });
                
                // add rtws geojson source
                map.addSource('rightToWorkStates', {
                    'type': 'geojson',
                    data: './rtwStates.geojson',
                });
                
                map.addLayer({
                        'id': 'RTWS',
                        'type': 'fill',
                        'source': 'rightToWorkStates',
                        paint: {
                            'fill-color': "rgba(0, 0, 0, 0.3)",
                        }
                    });
                map.setFilter('RTWS', ['==', 'id', 0]);
                
                // add geojson as a layer
                map.addLayer({
                    'id': 'plantYears',
                    'type': 'circle',
                    'source': 'ManfPlants',
                    paint: {
                        'circle-color': dataStyle[0],
                    }
                });  
            });
            
            // disable map rotation using right click + drag
            map.dragRotate.disable();

            // disable map rotation using touch rotation gesture
            map.touchZoomRotate.disableRotation();
            
            
            //////////////////////////////////////////////////////////
            // mapbox://styles/ptimmys/cli0j2lad00ul01po2d4t5fyo
            
            /////////////////////////////////////////////////////////
            ///    Code for styles:                               ///
            /////////////////////////////////////////////////////////
            
            
            const yearLi = [
                1960, 1961, 1962, 1963, 1964, 1965, 1966, 
                1967, 1968, 1969, 1970, 1971, 1972, 1973,
                1974, 1975, 1976, 1977, 1978, 1979, 1980, 
                1981, 1982, 1983, 1984, 1985, 1986, 1987,
                1988, 1989, 1990, 1991, 1992
            ];
            
            const dataStyle = [[
                                  "match",
                                  ["get", "SIC1"],
                                  0,
                                  [
                                    "interpolate",
                                    ["linear"],
                                    ["get", "SIC1"],
                                    2011,"#157CAE",2099,"#157CAE",

                                    2100,"#D7AA27",3299,"#D7AA27",

                                    3300,"#AF272F",3499,"#AF272F",

                                    3500,"#00AEEF",3599,"#00AEEF",

                                    3600,"#FFF200",3699,"#FFF200",

                                    3700,"#4D5859",3710,"#4D5859",

                                    3711,"#EC008C",3716,"#EC008C",

                                    3717,"#4D5859",3999,"#4D5859"

                                  ],
                                  [
                                    "interpolate",
                                    ["linear"],
                                    ["get", "SIC1"],
                                    2011,"#157CAE",2099,"#157CAE",

                                    2100,"#D7AA27",3299,"#D7AA27",

                                    3300,"#AF272F",3499,"#AF272F",

                                    3500,"#00AEEF",3599,"#00AEEF",

                                    3600,"#FFF200",3699,"#FFF200",

                                    3700,"#4D5859",3710,"#4D5859",

                                    3711,"#EC008C",3716,"#EC008C",

                                    3717,"#4D5859",3999,"#4D5859"
                                   ]
                                ]];
            
            
            /////////////////////////////////////////////////////////
            
            
            
            /////////////////////////////////////////////////////////
            //             Using a geojson file for now            //
            /////////////////////////////////////////////////////////
            
            
            
            
            
            //////////////////////////////////////////////////////////
            
            
            
            //////////////////////////////////////////////////////////
            //            This chunk handles DarkMode               //
            //////////////////////////////////////////////////////////
            var DM = 0;
            const DML = ['mapbox://styles/mapbox/light-v11', 'mapbox://styles/mapbox/dark-v11', 'mapbox://styles/ptimmys/cli0j2lad00ul01po2d4t5fyo'];
            
            function darkMode() {
                
                if (DM == 0) {
                    DM = 1;
                    map.setStyle(DML[DM]);
                } else {
                    DM = 0;
                    map.setStyle(DML[DM]);
                };
            };
            
            
            /////////////////////////////////////////////////////////
            
            var JovFilter = ['>=','IDNUM', 0];
            var AcqFilter = ['>=','IDNUM', 0];
            var NewFilter = ['>=','IDNUM', 0];
            var legendToggle = 1;
            var playToggle = 1;
            var filterTog = 1;
            
            /// info Modal ///
            
            var modal = document.getElementById("infoModal");
            var Leg = document.getElementById("LegendItems");
            var LegX = document.getElementById('legX');
            var tab = document.getElementById('TabsBB');
            var TABBIE = document.getElementById("TABBY");
            var usrCon = document.getElementById('userControl');
            var filCB = document.getElementById('FiltersCheckBox');
            var filbox = document.getElementById('FilterHiddenSection');
            var filX = document.getElementById('FilterX');
            var filHelp = document.getElementById('filterInfoModal');

            // Get the button that opens the modal
            var btn = document.getElementById("myBtn");

            // Get the <span> element that closes the modal
            var span = document.getElementsByClassName("close")[0];
            
            function infoBtn () {
                modal.style.display = "block";
            }
            
            
            span.onclick = function () {
                modal.style.display = 'none';
                filHelp.style.display = 'none';
            }
            
            function LegBtn () {
                if (legendToggle == 1) {
                    Leg.style.display = 'none';
                    LegX.innerHTML = '&plus;';
                    legendToggle = 0;
                } else {
                    Leg.style.display = 'block';
                    LegX.innerHTML = '&times;';
                    legendToggle = 1;
                }
            }
            
            function FilBtn () {
                if (filterTog == 1) {
                    filbox.style.display = 'none';
                    document.getElementById('FilX').innerHTML = '&plus;';
                    filterTog = 0;
                } else {
                    filbox.style.display = 'block';
                    document.getElementById('FilX').innerHTML = '&times;';
                    filterTog = 1;
                }
            }
            
            
            TABBIE.onclick = function() {
                if (playToggle == 0) {
                    usrCon.style.display = 'block';
                    TABBIE.style.top = '105px';
                    playToggle = 1;
                } else {
                    usrCon.style.display = 'none';
                    TABBIE.style.top = '50px';
                    playToggle = 0;
                }
            }
            
            
            
            filX.onclick = function() {
                filHelp.style.display = "block";
            }
            
            // When the user clicks anywhere outside of the modal, close it
            window.onclick = function(event) {
              if (event.target == modal) {
                modal.style.display = "none";
              } else if (event.target == filHelp) {
                filHelp.style.display = "none";
              }
            }
                
            
            var rtwsOn = 0;
            /// Right to work states add data 
            function rtwsBtn() {
                
                if (rtwsOn == 0) {
                    map.setFilter('RTWS', ['==', 'rtwID', 1]);
                    rtwsOn = 1;
                    
                } else if (rtwsOn == 1) {
                    map.setFilter('RTWS', ['==', 'id', 0]);
                    rtwsOn = 0;
                }

            };
            
            
            
            // js from https://webcodespace.com/how-to-create-a-three-state-toggle-switch-using-html-css-and-javascript/ //
            var jvbuttons = document.getElementsByClassName("jvButton");
            var jvarr = [...jvbuttons];

            jvarr.forEach((element, index) => {
                element.addEventListener("click", () => {
                    element.style.opacity = "1";
                    jvarr
                        .filter(function (item) {
                        return item != element;
                    })
                        .forEach((item) => {
                        item.style.opacity = "0";
                    });
                });
            });

            var aqbuttons = document.getElementsByClassName("aqButton");
            var aqarr = [...aqbuttons];

            aqarr.forEach((element, index) => {
                element.addEventListener("click", () => {
                    element.style.opacity = "1";
                    aqarr
                        .filter(function (item) {
                        return item != element;
                    })
                        .forEach((item) => {
                        item.style.opacity = "0";
                    });
                });
            }); 

            var nwbuttons = document.getElementsByClassName("nwButton");
            var nwarr = [...nwbuttons];

            nwarr.forEach((element, index) => {
                element.addEventListener("click", () => {
                    element.style.opacity = "1";
                    nwarr
                        .filter(function (item) {
                        return item != element;
                    })
                        .forEach((item) => {
                        item.style.opacity = "0";
                    });
                });
            }); 

///////////////////////////////////////////////////////////////////////////
            
            
            
            
            
            
            
            
            /////////////////////////////////////////////////////////
            //                    No UI Slider                     //
            /////////////////////////////////////////////////////////
            var playCon = 0;
            let ziggy = document.getElementById('minYear');
            let iggy = document.getElementById('maxYear');
            var slider = document.getElementById('slider');
            var select = document.getElementById('spanID');
            var minvalue = 0;
            var maxvalue = 32;
            var minYearFilter = ['<=', 'YEAR', 0];
            var maxYearFilter = ['>=', 'YEAR', 4000];
            var sicFilter = ['>=', 'SIC1', 0];
            var sicFilterMax = ['>=', 'SIC1', 0];
            var LockBottom = true;
            var LockTop = false;
            var AqF = 0;
            var NwF = 0;
            var JvF = 0;
            
            
            
            var slideEvList = noUiSlider.create(slider, {
                start: [0, 32],
                connect: true,
                range: {
                    'min': 0,
                    'max': 32
                },
                step: 1,
                behaviour: 'tap-drag',
            });
                
            
            
            // play button function
            function go() {
                if (playCon == 0) {
                    document.getElementById('playbutton').innerHTML = "Pause";
                    runTimer();
                    playCon = 1;
                    document.getElementById('playbutton').checked = true;
                } else {
                    document.getElementById('playbutton').innerHTML = "Play";
                    clearInterval(timer);
                    playCon = 0;
                    document.getElementById('playbutton').checked = false;
                }
            };
            
            // call the timer Function 
            function runTimer(){
                timer = setInterval(myTimer, 1000);
            };
            // timer funciton, updates slider values
            function myTimer() {
                var years = slider.noUiSlider.get();
                if (LockBottom == true) {
                    var minyears = Number(years[0]);
                } else {
                    var minyears = Number(years[0]) + 1;
                }
                if (LockTop == true) {
                    var maxyears = Number(years[1]);
                } else {
                    var maxyears = Number(years[1]) + 1;
                }
                
                if (maxyears > 32){
                    slider.noUiSlider.set([null, minyears]);
                } else {
                    slider.noUiSlider.set([minyears, maxyears]);
                }
            };
            
                        
            function yearTextContent(heldValues) {
                document.getElementById('maxYear').textContent = Number(heldValues[1]);
                document.getElementById('minYear').textContent = Number(heldValues[0]);
            };
            
            
            
            
            function lockbottom() {
                if (LockBottom==true) {
                    ziggy.style.color = '#fff9d1';
                    LockBottom = false;
                    
                } else {
                    ziggy.style.color = '#ffe008';
                    LockBottom = true;
                }
            };
            
            
            function locktop() {
                if (LockTop==true) {
                    iggy.style.color = '#fff9d1';
                    LockTop = false;
                } else {
                    iggy.style.color = '#ffe008';
                    LockTop = true;
                }
            };
            
            
            function settingTheFilter(something) {
                if (something == 'nojv') {
                    JovFilter = ['!=', 'JV', true];
                    
                    console.log(JovFilter);
                    
                } else if (something == 'jv') {
                    JovFilter = ['>=','IDNUM', 0];
                    
                } else if (something == 'alljv') {
                    JovFilter = ['==', 'JV', true];
                    
                } else if (something == 'noaq') {
                    AcqFilter = ['!=', 'ACQUIRE', true];
              
                } else if (something == 'aq') {
                    AcqFilter = ['>=','IDNUM', 0];
                
                } else if (something == 'allaq') {
                    AcqFilter = ['==', 'ACQUIRE', true];
                
                } else if (something == 'nonw') {
                    NewFilter = ['!=', 'NEW', true];
                
                } else if (something == 'nw') {
                    NewFilter = ['>=','IDNUM', 0];
                
                } else if (something == 'allnw') {
                    NewFilter = ['==', 'NEW', true];
                }
                
                map.setFilter('plantYears', ['all', maxYearFilter, minYearFilter, NewFilter, AcqFilter, JovFilter, sicFilter, sicFilterMax]);
            };
            
            
            
            
            
            
            const food = document.getElementById('food');
            const rawMaterials = document.getElementById('rawMaterials');
            const metal = document.getElementById('metal');
            const machinery = document.getElementById('machinery');
            const electronics = document.getElementById('electronics');
            const auto = document.getElementById('auto');
            const miscManf = document.getElementById('miscManf');
            
            
            
            
            
            function sicGo() {
                var inputVal = document.getElementById('sicVal').value;
                if (inputVal == '') {
                    sicFilter = ['>=', 'SIC1', 0];
                    sicFilterMax = ['>=', 'SIC1', 0];
                    document.getElementById('food').classList.remove('HiddenLegend');
                    document.getElementById('rawMaterials').classList.remove('HiddenLegend');
                    document.getElementById('metals').classList.remove('HiddenLegend');
                    document.getElementById('machinery').classList.remove('HiddenLegend');
                    document.getElementById('electronics').classList.remove('HiddenLegend');
                    document.getElementById('auto').classList.remove('HiddenLegend');
                    document.getElementById('miskManf').classList.remove('HiddenLegend');
                    
                    
                    
                    
                } else if (inputVal == 'Food') {
                    sicFilter = ['>=', 'SIC1', 2000];
                    sicFilterMax = ['<=', 'SIC1', 2100];
                    document.getElementById('food').classList.remove('HiddenLegend');
                    document.getElementById('metals').classList.add('HiddenLegend');
                    document.getElementById('rawMaterials').classList.add('HiddenLegend');
                    document.getElementById('machinery').classList.add('HiddenLegend');
                    document.getElementById('electronics').classList.add('HiddenLegend');
                    document.getElementById('auto').classList.add('HiddenLegend');
                    document.getElementById('miskManf').classList.add('HiddenLegend');
                
                
                } else if (inputVal == 'Misc') {
                    sicFilter = ['>=', 'SIC1', 3700];
                    sicFilterMax = ['<=', 'SIC1', 5000];
                    document.getElementById('miskManf').classList.remove('HiddenLegend');
                    document.getElementById('auto').classList.remove('HiddenLegend');
                    document.getElementById('metals').classList.add('HiddenLegend');
                    document.getElementById('rawMaterials').classList.add('HiddenLegend');
                    document.getElementById('machinery').classList.add('HiddenLegend');
                    document.getElementById('electronics').classList.add('HiddenLegend');
                    document.getElementById('food').classList.add('HiddenLegend');
                
                
                } else if (inputVal == 'Raw Materials') {
                    sicFilter = ['>=', 'SIC1', 2200];
                    sicFilterMax = ['<=', 'SIC1', 3299];
                    document.getElementById('rawMaterials').classList.remove('HiddenLegend');
                    document.getElementById('metals').classList.add('HiddenLegend');
                    document.getElementById('food').classList.add('HiddenLegend');
                    document.getElementById('machinery').classList.add('HiddenLegend');
                    document.getElementById('electronics').classList.add('HiddenLegend');
                    document.getElementById('auto').classList.add('HiddenLegend');
                    document.getElementById('miskManf').classList.add('HiddenLegend');
               
                
                } else if (inputVal == 'Metal') {
                    sicFilter = ['>=', 'SIC1', 3300];
                    sicFilterMax = ['<=', 'SIC1', 3499];
                    document.getElementById('metals').classList.remove('HiddenLegend');
                    document.getElementById('food').classList.add('HiddenLegend');
                    document.getElementById('rawMaterials').classList.add('HiddenLegend');
                    document.getElementById('machinery').classList.add('HiddenLegend');
                    document.getElementById('electronics').classList.add('HiddenLegend');
                    document.getElementById('auto').classList.add('HiddenLegend');
                    document.getElementById('miskManf').classList.add('HiddenLegend');
                
                
                } else if (inputVal == 'Machinery') {
                    sicFilter = ['>=', 'SIC1', 3500];
                    sicFilterMax = ['<=', 'SIC1', 3599];
                    document.getElementById('machinery').classList.remove('HiddenLegend');
                    document.getElementById('metals').classList.add('HiddenLegend');
                    document.getElementById('rawMaterials').classList.add('HiddenLegend');
                    document.getElementById('food').classList.add('HiddenLegend');
                    document.getElementById('electronics').classList.add('HiddenLegend');
                    document.getElementById('auto').classList.add('HiddenLegend');
                    document.getElementById('miskManf').classList.add('HiddenLegend');
                
                
                } else if (inputVal == 'Electronics') {
                    sicFilter = ['>=', 'SIC1', 3600];
                    sicFilterMax = ['<=', 'SIC1', 3699];
                    document.getElementById('electronics').classList.remove('HiddenLegend');
                    document.getElementById('metals').classList.add('HiddenLegend');
                    document.getElementById('rawMaterials').classList.add('HiddenLegend');
                    document.getElementById('machinery').classList.add('HiddenLegend');
                    document.getElementById('food').classList.add('HiddenLegend');
                    document.getElementById('auto').classList.add('HiddenLegend');
                    document.getElementById('miskManf').classList.add('HiddenLegend');
                
                
                } else if (inputVal == 'Automotives') {
                    sicFilter = ['>=', 'SIC1', 3711];
                    sicFilterMax = ['<=', 'SIC1', 3716];
                    document.getElementById('auto').classList.remove('HiddenLegend');
                    document.getElementById('metals').classList.add('HiddenLegend');
                    document.getElementById('rawMaterials').classList.add('HiddenLegend');
                    document.getElementById('machinery').classList.add('HiddenLegend');
                    document.getElementById('electronics').classList.add('HiddenLegend');
                    document.getElementById('food').classList.add('HiddenLegend');
                    document.getElementById('miskManf').classList.add('HiddenLegend');
               
                
                } else if (inputVal.length == 4) {
                    sicFilter = ['==', 'SIC1', Number(inputVal)];
                    sicFilterMax = ['==', 'SIC1', Number(inputVal)];
               
                
                } else if (inputVal.length == 9) {
                    var splitter = inputVal.split(' ')
                    sicFilter = ['<=', 'SIC1', Number(splitter[1])];
                    sicFilterMax = ['>=', 'SIC1', Number(splitter[0])];
               
                
                } else {
                    document.getElementById('sicVal').innerHTML = "Error";
                }
                
                
                map.setFilter('plantYears', ['all', maxYearFilter, minYearFilter, NewFilter, AcqFilter, JovFilter, sicFilter, sicFilterMax]);
            }
           
            function sicValClick() {
                document.getElementById('sicVal').value = '';
            }
            
            
            
            
            slideEvList.on('update', function(values){
                minvalue = Number(values[0]);
                minvalue = yearLi[minvalue];
                minYearFilter = ['>=', 'YEAR', minvalue]

                maxvalue = Number(values[1]);
                maxvalue = yearLi[maxvalue];
                maxYearFilter = ['<=', 'YEAR', maxvalue]
                    
                
                setFilterFunction();

                var filters = [minvalue, maxvalue];

                yearTextContent(filters);
                });
            
            slider.noUiSlider.on('update', function (values, handle) {
                var value = values[handle];
                
                select.textContent = Math.round(values[1]-values[0]);
                
                if (handle) {
                    inputNumber.value = value;
                } else {
                    select.value = Math.round(values[1]-values[0]);
                };
            });
            
            select.addEventListener('change', function () {
                slider.noUiSlider.set([this.value, null]);
            });
            
            function setFilterFunction () {
                map.setFilter('plantYears', ['all', maxYearFilter, minYearFilter, NewFilter, AcqFilter, JovFilter, sicFilter, sicFilterMax]);
            }
            
            
            /* Switch JS code from https://webcodespace.com/how-to-create-a-three-state-toggle-switch-using-html-css-and-javascript/ */
            
            
           
            
        </script>
    </body>
</html>
